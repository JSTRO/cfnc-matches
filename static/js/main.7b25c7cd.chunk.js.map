{"version":3,"sources":["App.js","exportToCsv.js","index.js"],"names":["App","useState","matches","setMatches","fileUploaded","setFileUploaded","email","age","age_pref","religion_important","want_children","politics_important","politics","ageChoices","findMatches","rows","map","row1","filter","row2","indexOf","row","match","length","console","log","output","i","a","b","j","push","uniqBy","item","JSON","stringify","splice","className","type","name","accept","onChange","e","readable","target","files","papa","parse","header","complete","data","handleChange","Button","variant","onClick","fileName","d","Date","isoDate","toISOString","slice","dateTime","getHours","getMinutes","getSeconds","formatCsvName","filename","processRow","finalVal","innerValue","toString","toLocaleString","result","replace","search","csvFile","blob","Blob","navigator","msSaveBlob","link","document","createElement","undefined","download","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","exportToCsv","alert","ReactDOM","render","StrictMode","getElementById"],"mappings":"iQA2KeA,MAnKf,WAAgB,IAAD,EAEiBC,mBAAS,IAF1B,mBAENC,EAFM,KAEGC,EAFH,OAG2BF,oBAAS,GAHpC,mBAGNG,EAHM,KAGQC,EAHR,KAkCPC,EAAQ,gBAERC,EAAM,YAENC,EAAW,0CACXC,EAAqB,6DAErBC,EAAgB,gCAGhBC,EAAqB,yEACrBC,EAAW,kCAGXC,EAAa,CAAC,YAAa,WAAY,YAAa,WAAY,YAAa,WAAY,OAAQ,OAGjGC,EAAc,SAAAC,GAClB,IAAMb,EAAUa,EAAKC,KAAI,SAAAC,GACvB,MAAQ,CACNA,EAAKX,GACLS,EAAKG,QAAO,SAAAC,GACV,OAEGF,EAAKX,KAAWa,EAAKb,IAErBW,EAvBS,iCAuBaE,EAzBlB,WAyBkCF,EAzBlC,YAyBmDE,EAvB9C,iCA0BS,WAAjBF,EA5BG,UA8BDA,EAAKT,KAAcK,EAAWA,EAAWO,QAAQD,EAAKZ,MACtDU,EAAKT,KAAcK,EAAWA,EAAWO,QAAQD,EAAKZ,IAAQ,GAE/C,WAAjBY,EAjCG,UAmCDA,EAAKX,KAAcK,EAAWA,EAAWO,QAAQH,EAAKV,MACtDY,EAAKX,KAAcK,EAAWA,EAAWO,QAAQH,EAAKV,IAAQ,GAC5D,QAIa,SAAjBU,EAzCG,UA2CDA,EAAKT,KAAcK,EAAWA,EAAWO,QAAQD,EAAKZ,MACtDU,EAAKT,KAAcK,EAAWA,EAAWO,QAAQD,EAAKZ,IAAQ,GAE/C,SAAjBY,EA9CG,UAgDDA,EAAKX,KAAcK,EAAWA,EAAWO,QAAQH,EAAKV,MACtDY,EAAKX,KAAcK,EAAWA,EAAWO,QAAQH,EAAKV,IAAQ,GAC5D,OAELU,EAAI,OAAWE,EAAI,OAGM,QAAxBF,EAhDU,2CAgD8C,OAAxBE,EA/CtB,yBAgDc,QAAxBA,EAjDU,2CAiD8C,OAAxBF,EAhDtB,yBAgDqD,QAGjC,QAA7BA,EAAKR,IAA8D,QAA7BU,EAAKV,GAC5CQ,EAvDK,4BAuDcE,EAvDd,0BAuD+B,QAKJ,QAA7BF,EAAKN,IAAoD,aAAnBM,EAAKL,IACd,QAA7BO,EAAKR,IAAoD,aAAnBQ,EAAKP,GAE9CK,EAAKL,KAAcO,EAAKP,GACvBK,EAAKL,KAAcO,EAAKP,IAAaK,EAAKL,KAAcO,EAAKP,MAItC,WAAxBK,EAAKP,GACLO,EAAKP,KAAmBS,EAAKT,GAC5BO,EAAKP,KAAmBS,EAAKT,IAAkBO,EAAKP,KAAmBS,EAAKT,OAGhFM,KAAI,SAAAK,GAAG,OAAIA,EAAIf,UAEnBY,QAAO,SAAAI,GAAK,OAAIA,EAAM,GAAGC,OAAS,KAErCC,QAAQC,IAAI,UAAWvB,GAIvB,IADA,IAAIwB,EAAS,GACJC,EAAE,EAAGA,EAAEzB,EAAQqB,OAAQI,IAAK,CACnC,IAAMC,EAAI1B,EAAQyB,GAAG,GACfE,EAAI3B,EAAQyB,GAAG,GACrB,GAAIE,EAAEN,OAAS,EACb,IAAK,IAAIO,EAAE,EAAGA,EAAED,EAAEN,OAAQO,IACxBJ,EAAOK,KAAK,CAACH,EAAGC,EAAEC,UAGpBJ,EAAOK,KAAK,CAACH,EAAGC,EAAE,KAKtBH,EAASM,iBAAON,GAAQ,SAAAO,GAAI,OAAIC,KAAKC,UAAUF,MAG/C,IAAK,IAAIN,EAAE,EAAGA,EAAED,EAAOH,OAAQI,IAC7B,IAAK,IAAIG,EAAE,EAAGA,EAAEJ,EAAOH,OAAQO,IACzBJ,EAAOC,GAAG,KAAOD,EAAOI,GAAG,IAAMJ,EAAOC,GAAG,KAAOD,EAAOI,GAAG,IAC9DJ,EAAOU,OAAOV,EAAON,QAAQM,EAAOI,IAAK,GAK/C,OAAOJ,GAGT,OACE,yBAAKW,UAAU,OACb,yBAAKA,UAAU,mBACb,6CACA,yBAAKA,UAAU,SACb,2BAAOC,KAAK,OAAOC,KAAK,OAAOC,OAAO,OAAOC,SAAU,SAAAC,GAAC,OApJ3C,SAAAA,GAAM,IAEnBC,EADYD,EAAEE,OAAZC,MACe,GACvBxC,GAAgB,GAChByC,IAAKC,MAAMJ,EAAU,CACnBK,QAAQ,EACRC,SAAU,SAAAC,GACR/C,EAAWW,EAAYoC,EAAKA,UA6IkCC,CAAaT,MACzE,kBAACU,EAAA,EAAD,CAAQC,QAAQ,UAAUC,QAlId,WAClB,IAAMC,EARc,WACpB,IAAMC,EAAI,IAAIC,KACRC,EAAUF,EAAEG,cAAcC,MAAM,EAAG,IACnCC,EAAQ,UAAMH,EAAN,YAAiBF,EAAEM,WAAnB,YAAiCN,EAAEO,aAAnC,YAAmDP,EAAEQ,cACnE,MAAM,WAAN,OAAkBH,EAAlB,QAIiBI,GACZ7D,EClCM,SAAqB8D,EAAUnD,GAmB5C,IAlBA,IAAMoD,EAAa,SAAU9C,GAE3B,IADA,IAAI+C,EAAW,GACNtC,EAAI,EAAGA,EAAIT,EAAIE,OAAQO,IAAK,CACnC,IAAIuC,EAAwB,OAAXhD,EAAIS,GAAc,GAAKT,EAAIS,GAAGwC,WAC3CjD,EAAIS,aAAc2B,OAClBY,EAAahD,EAAIS,GAAGyC,kBAExB,IAAIC,EAASH,EAAWI,QAAQ,KAAM,MAClCD,EAAOE,OAAO,cAAgB,IAC9BF,EAAS,IAAMA,EAAS,KACxB1C,EAAI,IACJsC,GAAY,KAChBA,GAAYI,EAEd,OAAOJ,EAAW,MAGhBO,EAAU,GACLhD,EAAI,EAAGA,EAAIZ,EAAKQ,OAAQI,IAC/BgD,GAAWR,EAAWpD,EAAKY,IAG7B,IAAIiD,EAAO,IAAIC,KAAK,CAACF,GAAU,CAAErC,KAAM,4BACvC,GAAIwC,UAAUC,WACVD,UAAUC,WAAWH,EAAMV,OACxB,CACL,IAAIc,EAAOC,SAASC,cAAc,KAClC,QAAsBC,IAAlBH,EAAKI,SAAwB,CAE/B,IAAIC,EAAMC,IAAIC,gBAAgBX,GAC9BI,EAAKQ,aAAa,OAAQH,GAC1BL,EAAKQ,aAAa,WAAYtB,GAC9Bc,EAAKS,MAAMC,WAAa,SACxBT,SAASU,KAAKC,YAAYZ,GAC1BA,EAAKa,QACLZ,SAASU,KAAKG,YAAYd,KDC1Be,CAAYxC,EAAUrD,GAFtB8F,MAAM,2BA+HF,wBE7JVC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFlB,SAASmB,eAAe,U","file":"static/js/main.7b25c7cd.chunk.js","sourcesContent":["import React, {useState} from 'react';\nimport './App.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport Button from 'react-bootstrap/Button'\nimport papa from 'papaparse'\nimport { uniqBy } from 'lodash'\nimport exportToCsv from './exportToCsv.js'\n\nfunction App() {\n\n  const [matches, setMatches] = useState([])\n  const [fileUploaded, setFileUploaded] = useState(false)\n\n  const handleChange = e => {\n    const { files } = e.target\n    const readable = files[0]\n    setFileUploaded(true)\n    papa.parse(readable, {\n      header: true,\n      complete: data => {\n        setMatches(findMatches(data.data))\n      }\n    });\n  }\n\n  const formatCsvName = () => {\n    const d = new Date()\n    const isoDate = d.toISOString().slice(0, 10)\n    const dateTime = `${isoDate}_${d.getHours()}_${d.getMinutes()}_${d.getSeconds()}`\n    return `matches_${dateTime}.csv`\n  }\n  \n  const handleClick = () => {\n    const fileName = formatCsvName()\n    if (!fileUploaded) {\n      alert(\"Please choose a file.\")\n    } else {\n      exportToCsv(fileName, matches)\n    }\n  }\n\n  // Convert form column headers into variables\n  const email = 'Email Address'\n  const gender = 'I am a'\n  const age = 'I am aged'\n  const gender_pref = 'I am interested in dating a'\n  const age_pref = 'I am interested in dating someone aged '\n  const religion_important = 'It is important that my partner is the same religion as me'\n  const religion = 'What religion are you?'\n  const want_children = 'Do you want to have children?'\n  const mind_children = 'Do you mind if your match has children?'\n  const have_children = 'Do you have children?'\n  const politics_important = 'It is important that my partner has the same political beliefs as I do'\n  const politics = 'If so, my political beliefs are'\n  const city = 'City'\n\n  const ageChoices = ['Early 20s', 'Late 20s', 'Early 30s', 'Late 30s', 'Early 40s', 'Late 40s', '50s+', '60+']\n\n  // TODO: Refactor this function\n  const findMatches = rows => {\n    const matches = rows.map(row1 => {\n      return ([\n        row1[email],\n        rows.filter(row2 => {\n          return (\n            // Cannot match with self\n            (row1[email] !== row2[email]) &&\n            // Match to gender preference\n            (row1[gender_pref] === row2[gender] && row1[gender] === row2[gender_pref]) &&\n            // Females match with their age range + one above\n            (\n              row1[gender] === \"Female\" ? \n              (\n                row1[age_pref] === ageChoices[ageChoices.indexOf(row2[age])] ||\n                row1[age_pref] === ageChoices[ageChoices.indexOf(row2[age]) + 1] \n              ) : null ||\n              row2[gender] === \"Female\" ?\n              (\n                row2[age_pref] === ageChoices[ageChoices.indexOf(row1[age])] ||\n                row2[age_pref] === ageChoices[ageChoices.indexOf(row1[age]) + 1]\n              ) : null\n            ) &&\n            // Male match with their age range + one below\n            (\n              row1[gender] === \"Male\" ?\n              (\n                row1[age_pref] === ageChoices[ageChoices.indexOf(row2[age])] ||\n                row1[age_pref] === ageChoices[ageChoices.indexOf(row2[age]) - 1]\n              ) : null ||\n              row2[gender] === \"Male\" ?\n              (\n                row2[age_pref] === ageChoices[ageChoices.indexOf(row1[age])] ||\n                row2[age_pref] === ageChoices[ageChoices.indexOf(row1[age]) - 1]\n              ) : null\n            ) &&\n            (row1[city] === row2[city]) &&\n            // If either person minds children, their match should not have children\n            (\n              row1[mind_children] === \"Yes\" ? row2[have_children] === \"No\" :\n              row2[mind_children] === \"Yes\" ? row1[have_children] === 'No' : null\n            ) &&\n            (\n              (row1[religion_important] === 'Yes' || row2[religion_important] === 'Yes') ? \n              row1[religion] === row2[religion] : null\n            ) &&\n            // Moderates can match with whoever\n            (\n              (\n                (row1[politics_important] === 'Yes' && row1[politics] !== 'Moderate') || \n                (row2[politics_important] === 'Yes' && row2[politics] !== 'Moderate')\n              ) ?\n              row1[politics] === row2[politics] : \n              (row1[politics] === row2[politics] || row1[politics] !== row2[politics])\n            ) &&\n            // Children: unsure can match with whoever\n            (\n              row1[want_children] !== \"Unsure\" ?\n              row1[want_children] === row2[want_children] : \n              (row1[want_children] === row2[want_children] || row1[want_children] !== row2[want_children])\n            ) \n          )\n        }).map(row => row[email])\n      ])\n    }).filter(match => match[1].length > 0) // Remove rows with no matches\n\n    console.log(\"matches\", matches)\n    \n    // Format as all possible matches                 \n    let output = []\n    for (let i=0; i<matches.length; i++) {\n      const a = matches[i][0]\n      const b = matches[i][1]\n      if (b.length > 1) {\n        for (let j=0; j<b.length; j++) {\n          output.push([a, b[j]])\n        }\n      } else {\n        output.push([a, b[0]])\n      }\n    }\n\n    // Only include unique entries\n    output = uniqBy(output, item => JSON.stringify(item))\n    \n    // Only include one side of matches\n    for (let i=0; i<output.length; i++) {\n      for (let j=0; j<output.length; j++) {\n        if (output[i][0] === output[j][1] && output[i][1] === output[j][0]) {\n          output.splice(output.indexOf(output[j]), 1)\n        }\n      }\n    }\n\n    return output\n  } \n\n  return (\n    <div className=\"App\">\n      <div className=\"container-fluid\">\n        <h1>#CFNC Matches</h1>\n        <div className=\"input\">\n          <input type=\"file\" name=\"file\" accept=\".csv\" onChange={e => handleChange(e)}/>\n          <Button variant=\"success\" onClick={handleClick}>\n            Download Matches\n          </Button> \n        </div>\n      </div>  \n    </div>\n  )\n}\n\nexport default App;\n","export default function exportToCsv(filename, rows) {\n  const processRow = function (row) {\n    var finalVal = '';\n    for (var j = 0; j < row.length; j++) {\n      var innerValue = row[j] === null ? '' : row[j].toString();\n      if (row[j] instanceof Date) {\n          innerValue = row[j].toLocaleString();\n      };\n      var result = innerValue.replace(/\"/g, '\"\"');\n      if (result.search(/(\"|,|\\n)/g) >= 0)\n          result = '\"' + result + '\"';\n      if (j > 0)\n          finalVal += ',';\n      finalVal += result;\n    }\n    return finalVal + '\\n';\n  };\n\n  var csvFile = '';\n  for (var i = 0; i < rows.length; i++) {\n    csvFile += processRow(rows[i]);\n  }\n\n  var blob = new Blob([csvFile], { type: 'text/csv;charset=utf-8;' });\n  if (navigator.msSaveBlob) { // IE 10+\n      navigator.msSaveBlob(blob, filename);\n  } else {\n    var link = document.createElement(\"a\");\n    if (link.download !== undefined) { // feature detection\n      // Browsers that support HTML5 download attribute\n      var url = URL.createObjectURL(blob);\n      link.setAttribute(\"href\", url);\n      link.setAttribute(\"download\", filename);\n      link.style.visibility = 'hidden';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    }\n  }\n}\n\n// Credit: https://jsfiddle.net/jossef/m3rrLzk0/","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}